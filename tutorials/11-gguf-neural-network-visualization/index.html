<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="CUDA 12 inference backend for Unsloth with multi-GPU support on Kaggle. Deploy fine-tuned models on dual Tesla T4 GPUs with llama.cpp server, GGUF quantization, and Graphistry visualization. Run 70B models with tensor-split architecture."><meta name=author content="Waqas Muhammad"><link href=https://llcuda.github.io/tutorials/11-gguf-neural-network-visualization/ rel=canonical><link href=../10-complete-workflow/ rel=prev><link href=../../architecture/overview/ rel=next><link rel=icon href=../../assets/images/logo.svg><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>â­ 11: GGUF Neural Network Visualization - llcuda v2.2.0 - CUDA12 Inference Backend for Unsloth</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-XXXXXXXXXX"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-XXXXXXXXXX",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=deep-purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#tutorial-11-gguf-neural-network-architecture-visualization class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="llcuda v2.2.0 - CUDA12 Inference Backend for Unsloth" class="md-header__button md-logo" aria-label="llcuda v2.2.0 - CUDA12 Inference Backend for Unsloth" data-md-component=logo> <img src=../../assets/images/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> llcuda v2.2.0 - CUDA12 Inference Backend for Unsloth </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> â­ 11: GGUF Neural Network Visualization </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=deep-purple aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=deep-purple aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/llcuda/llcuda title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> llcuda/llcuda </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="llcuda v2.2.0 - CUDA12 Inference Backend for Unsloth" class="md-nav__button md-logo" aria-label="llcuda v2.2.0 - CUDA12 Inference Backend for Unsloth" data-md-component=logo> <img src=../../assets/images/logo.svg alt=logo> </a> llcuda v2.2.0 - CUDA12 Inference Backend for Unsloth </label> <div class=md-nav__source> <a href=https://github.com/llcuda/llcuda title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> llcuda/llcuda </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> llcuda v2.2.0 </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Learn </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Learn </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1 id=__nav_2_1_label tabindex=0> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../guides/quickstart/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class=md-nav__item> <a href=../../guides/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../guides/first-steps/ class=md-nav__link> <span class=md-ellipsis> First Steps </span> </a> </li> <li class=md-nav__item> <a href=../../guides/kaggle-setup/ class=md-nav__link> <span class=md-ellipsis> Kaggle Setup </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class=md-ellipsis> Kaggle Dual T4 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Kaggle Dual T4 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../kaggle/overview/ class=md-nav__link> <span class=md-ellipsis> Kaggle Dual T4 Overview </span> </a> </li> <li class=md-nav__item> <a href=../../kaggle/dual-gpu-setup/ class=md-nav__link> <span class=md-ellipsis> Dual GPU Setup </span> </a> </li> <li class=md-nav__item> <a href=../../kaggle/multi-gpu-inference/ class=md-nav__link> <span class=md-ellipsis> Multi-GPU Inference </span> </a> </li> <li class=md-nav__item> <a href=../../kaggle/tensor-split/ class=md-nav__link> <span class=md-ellipsis> Tensor Split Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../kaggle/large-models/ class=md-nav__link> <span class=md-ellipsis> Running 70B Models </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Tutorial Notebooks </span> </a> <label class="md-nav__link " for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=true> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Tutorial Notebooks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../01-quickstart/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class=md-nav__item> <a href=../02-server-setup/ class=md-nav__link> <span class=md-ellipsis> Server Setup </span> </a> </li> <li class=md-nav__item> <a href=../03-multi-gpu/ class=md-nav__link> <span class=md-ellipsis> Multi-GPU Inference </span> </a> </li> <li class=md-nav__item> <a href=../04-gguf-quantization/ class=md-nav__link> <span class=md-ellipsis> GGUF Quantization </span> </a> </li> <li class=md-nav__item> <a href=../05-unsloth-integration/ class=md-nav__link> <span class=md-ellipsis> Unsloth Integration </span> </a> </li> <li class=md-nav__item> <a href=../06-split-gpu-graphistry/ class=md-nav__link> <span class=md-ellipsis> Split-GPU with Graphistry </span> </a> </li> <li class=md-nav__item> <a href=../07-openai-api/ class=md-nav__link> <span class=md-ellipsis> OpenAI API Client </span> </a> </li> <li class=md-nav__item> <a href=../08-nccl-pytorch/ class=md-nav__link> <span class=md-ellipsis> NCCL and PyTorch </span> </a> </li> <li class=md-nav__item> <a href=../09-large-models/ class=md-nav__link> <span class=md-ellipsis> Large Models on Kaggle </span> </a> </li> <li class=md-nav__item> <a href=../10-complete-workflow/ class=md-nav__link> <span class=md-ellipsis> Complete Workflow </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> â­ 11: GGUF Neural Network Visualization </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> â­ 11: GGUF Neural Network Visualization </span> </a> <nav class="md-nav md-nav--secondary" aria-label="On this page"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> On this page </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> ğŸ¯ Overview </span> </a> <nav class=md-nav aria-label="ğŸ¯ Overview"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#why-this-tutorial-is-critical class=md-nav__link> <span class=md-ellipsis> Why This Tutorial is Critical </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#what-youll-visualize class=md-nav__link> <span class=md-ellipsis> ğŸ“Š What You'll Visualize </span> </a> <nav class=md-nav aria-label="ğŸ“Š What You'll Visualize"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#complete-model-architecture class=md-nav__link> <span class=md-ellipsis> Complete Model Architecture </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#architecture-statistics class=md-nav__link> <span class=md-ellipsis> ğŸ—ï¸ Architecture Statistics </span> </a> <nav class=md-nav aria-label="ğŸ—ï¸ Architecture Statistics"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#node-distribution class=md-nav__link> <span class=md-ellipsis> Node Distribution </span> </a> </li> <li class=md-nav__item> <a href=#edge-distribution class=md-nav__link> <span class=md-ellipsis> Edge Distribution </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#visual-components class=md-nav__link> <span class=md-ellipsis> ğŸ¨ Visual Components </span> </a> <nav class=md-nav aria-label="ğŸ¨ Visual Components"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-main-architecture-dashboard-929-nodes class=md-nav__link> <span class=md-ellipsis> 1. Main Architecture Dashboard (929 Nodes) </span> </a> </li> <li class=md-nav__item> <a href=#2-layer-specific-visualizations-layers-1-5 class=md-nav__link> <span class=md-ellipsis> 2. Layer-Specific Visualizations (Layers 1-5) </span> </a> </li> <li class=md-nav__item> <a href=#3-attention-head-analysis-896-nodes class=md-nav__link> <span class=md-ellipsis> 3. Attention Head Analysis (896 Nodes) </span> </a> </li> <li class=md-nav__item> <a href=#4-quantization-block-visualization-112-nodes class=md-nav__link> <span class=md-ellipsis> 4. Quantization Block Visualization (112 Nodes) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#technical-implementation class=md-nav__link> <span class=md-ellipsis> ğŸ”¬ Technical Implementation </span> </a> <nav class=md-nav aria-label="ğŸ”¬ Technical Implementation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#split-gpu-architecture class=md-nav__link> <span class=md-ellipsis> Split-GPU Architecture </span> </a> </li> <li class=md-nav__item> <a href=#data-flow class=md-nav__link> <span class=md-ellipsis> Data Flow </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-by-step-walkthrough class=md-nav__link> <span class=md-ellipsis> ğŸ“ Step-by-Step Walkthrough </span> </a> <nav class=md-nav aria-label="ğŸ“ Step-by-Step Walkthrough"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#part-1-environment-setup-cells-1-10 class=md-nav__link> <span class=md-ellipsis> Part 1: Environment Setup (Cells 1-10) </span> </a> </li> <li class=md-nav__item> <a href=#part-2-model-setup-cells-11-20 class=md-nav__link> <span class=md-ellipsis> Part 2: Model Setup (Cells 11-20) </span> </a> </li> <li class=md-nav__item> <a href=#part-3-architecture-extraction-cells-21-30 class=md-nav__link> <span class=md-ellipsis> Part 3: Architecture Extraction (Cells 21-30) </span> </a> </li> <li class=md-nav__item> <a href=#part-4-gpu-accelerated-analytics-cells-31-40 class=md-nav__link> <span class=md-ellipsis> Part 4: GPU-Accelerated Analytics (Cells 31-40) </span> </a> </li> <li class=md-nav__item> <a href=#part-5-interactive-visualization-cells-41-60 class=md-nav__link> <span class=md-ellipsis> Part 5: Interactive Visualization (Cells 41-60) </span> </a> </li> <li class=md-nav__item> <a href=#part-6-complete-dashboard-export-cells-61-70 class=md-nav__link> <span class=md-ellipsis> Part 6: Complete Dashboard Export (Cells 61-70) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#key-learnings class=md-nav__link> <span class=md-ellipsis> ğŸ“ Key Learnings </span> </a> <nav class=md-nav aria-label="ğŸ“ Key Learnings"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-architecture-insights class=md-nav__link> <span class=md-ellipsis> 1. Architecture Insights </span> </a> </li> <li class=md-nav__item> <a href=#2-quantization-impact class=md-nav__link> <span class=md-ellipsis> 2. Quantization Impact </span> </a> </li> <li class=md-nav__item> <a href=#3-split-gpu-benefits class=md-nav__link> <span class=md-ellipsis> 3. Split-GPU Benefits </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#research-applications class=md-nav__link> <span class=md-ellipsis> ğŸ” Research Applications </span> </a> <nav class=md-nav aria-label="ğŸ” Research Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#model-analysis class=md-nav__link> <span class=md-ellipsis> Model Analysis </span> </a> </li> <li class=md-nav__item> <a href=#optimization class=md-nav__link> <span class=md-ellipsis> Optimization </span> </a> </li> <li class=md-nav__item> <a href=#debugging class=md-nav__link> <span class=md-ellipsis> Debugging </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#outputs class=md-nav__link> <span class=md-ellipsis> ğŸ“ Outputs </span> </a> <nav class=md-nav aria-label="ğŸ“ Outputs"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#files-generated class=md-nav__link> <span class=md-ellipsis> Files Generated </span> </a> </li> <li class=md-nav__item> <a href=#cloud-urls-8-total class=md-nav__link> <span class=md-ellipsis> Cloud URLs (8 total) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#next-steps class=md-nav__link> <span class=md-ellipsis> ğŸš€ Next Steps </span> </a> <nav class=md-nav aria-label="ğŸš€ Next Steps"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#after-completing-this-tutorial class=md-nav__link> <span class=md-ellipsis> After Completing This Tutorial </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> <span class=md-ellipsis> ğŸ› ï¸ Troubleshooting </span> </a> <nav class=md-nav aria-label="ğŸ› ï¸ Troubleshooting"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#common-issues class=md-nav__link> <span class=md-ellipsis> Common Issues </span> </a> </li> <li class=md-nav__item> <a href=#performance-optimization class=md-nav__link> <span class=md-ellipsis> Performance Optimization </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#additional-resources class=md-nav__link> <span class=md-ellipsis> ğŸ“š Additional Resources </span> </a> <nav class=md-nav aria-label="ğŸ“š Additional Resources"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#related-tutorials class=md-nav__link> <span class=md-ellipsis> Related Tutorials </span> </a> </li> <li class=md-nav__item> <a href=#external-documentation class=md-nav__link> <span class=md-ellipsis> External Documentation </span> </a> </li> <li class=md-nav__item> <a href=#academic-papers class=md-nav__link> <span class=md-ellipsis> Academic Papers </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#conclusion class=md-nav__link> <span class=md-ellipsis> ğŸ‰ Conclusion </span> </a> </li> <li class=md-nav__item> <a href=#citation class=md-nav__link> <span class=md-ellipsis> ğŸ“– Citation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex=0> <span class=md-ellipsis> Architecture </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../architecture/overview/ class=md-nav__link> <span class=md-ellipsis> Architecture Overview </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/split-gpu/ class=md-nav__link> <span class=md-ellipsis> Split-GPU Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/gpu0-llm/ class=md-nav__link> <span class=md-ellipsis> GPU 0 - LLM Inference </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/gpu1-graphistry/ class=md-nav__link> <span class=md-ellipsis> GPU 1 - Graphistry </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/tensor-split-vs-nccl/ class=md-nav__link> <span class=md-ellipsis> Tensor Split vs NCCL </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5> <label class=md-nav__link for=__nav_2_5 id=__nav_2_5_label tabindex=0> <span class=md-ellipsis> Unsloth Integration </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Unsloth Integration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../unsloth/overview/ class=md-nav__link> <span class=md-ellipsis> Unsloth Integration </span> </a> </li> <li class=md-nav__item> <a href=../../unsloth/fine-tuning/ class=md-nav__link> <span class=md-ellipsis> Fine-Tuning Workflow </span> </a> </li> <li class=md-nav__item> <a href=../../unsloth/gguf-export/ class=md-nav__link> <span class=md-ellipsis> GGUF Export </span> </a> </li> <li class=md-nav__item> <a href=../../unsloth/deployment/ class=md-nav__link> <span class=md-ellipsis> Deployment Pipeline </span> </a> </li> <li class=md-nav__item> <a href=../../unsloth/best-practices/ class=md-nav__link> <span class=md-ellipsis> Best Practices </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_6> <label class=md-nav__link for=__nav_2_6 id=__nav_2_6_label tabindex=0> <span class=md-ellipsis> Graphistry & Visualization </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6> <span class="md-nav__icon md-icon"></span> Graphistry & Visualization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../graphistry/overview/ class=md-nav__link> <span class=md-ellipsis> Graphistry Integration </span> </a> </li> <li class=md-nav__item> <a href=../../graphistry/knowledge-graphs/ class=md-nav__link> <span class=md-ellipsis> Knowledge Graph Extraction </span> </a> </li> <li class=md-nav__item> <a href=../../graphistry/rapids/ class=md-nav__link> <span class=md-ellipsis> RAPIDS Integration </span> </a> </li> <li class=md-nav__item> <a href=../../graphistry/split-gpu-setup/ class=md-nav__link> <span class=md-ellipsis> Split-GPU Setup </span> </a> </li> <li class=md-nav__item> <a href=../../graphistry/examples/ class=md-nav__link> <span class=md-ellipsis> Graphistry Examples </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_7> <label class=md-nav__link for=__nav_2_7 id=__nav_2_7_label tabindex=0> <span class=md-ellipsis> Performance </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_7_label aria-expanded=false> <label class=md-nav__title for=__nav_2_7> <span class="md-nav__icon md-icon"></span> Performance </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../performance/benchmarks/ class=md-nav__link> <span class=md-ellipsis> Performance Benchmarks </span> </a> </li> <li class=md-nav__item> <a href=../../performance/dual-t4-results/ class=md-nav__link> <span class=md-ellipsis> Dual T4 Performance </span> </a> </li> <li class=md-nav__item> <a href=../../performance/optimization/ class=md-nav__link> <span class=md-ellipsis> Optimization Guide </span> </a> </li> <li class=md-nav__item> <a href=../../performance/memory/ class=md-nav__link> <span class=md-ellipsis> Memory Management </span> </a> </li> <li class=md-nav__item> <a href=../../performance/flash-attention/ class=md-nav__link> <span class=md-ellipsis> FlashAttention </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_8> <label class=md-nav__link for=__nav_2_8 id=__nav_2_8_label tabindex=0> <span class=md-ellipsis> GGUF & Quantization </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_8_label aria-expanded=false> <label class=md-nav__title for=__nav_2_8> <span class="md-nav__icon md-icon"></span> GGUF & Quantization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../gguf/overview/ class=md-nav__link> <span class=md-ellipsis> GGUF Format Overview </span> </a> </li> <li class=md-nav__item> <a href=../../gguf/k-quants/ class=md-nav__link> <span class=md-ellipsis> K-Quants Guide </span> </a> </li> <li class=md-nav__item> <a href=../../gguf/i-quants/ class=md-nav__link> <span class=md-ellipsis> I-Quants (Importance Quantization) </span> </a> </li> <li class=md-nav__item> <a href=../../gguf/selection/ class=md-nav__link> <span class=md-ellipsis> GGUF Format Selection Guide </span> </a> </li> <li class=md-nav__item> <a href=../../gguf/vram-estimation/ class=md-nav__link> <span class=md-ellipsis> VRAM Estimation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_9> <label class=md-nav__link for=__nav_2_9 id=__nav_2_9_label tabindex=0> <span class=md-ellipsis> Guides </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_9_label aria-expanded=false> <label class=md-nav__title for=__nav_2_9> <span class="md-nav__icon md-icon"></span> Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../guides/model-selection/ class=md-nav__link> <span class=md-ellipsis> Model Selection Guide </span> </a> </li> <li class=md-nav__item> <a href=../../guides/troubleshooting/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting Guide </span> </a> </li> <li class=md-nav__item> <a href=../../guides/faq/ class=md-nav__link> <span class=md-ellipsis> Frequently Asked Questions </span> </a> </li> <li class=md-nav__item> <a href=../../guides/build-from-source/ class=md-nav__link> <span class=md-ellipsis> Build from Source </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> API Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api/overview/ class=md-nav__link> <span class=md-ellipsis> API Reference Overview </span> </a> </li> <li class=md-nav__item> <a href=../../api/client/ class=md-nav__link> <span class=md-ellipsis> LlamaCppClient API </span> </a> </li> <li class=md-nav__item> <a href=../../api/server/ class=md-nav__link> <span class=md-ellipsis> ServerManager API </span> </a> </li> <li class=md-nav__item> <a href=../../api/multigpu/ class=md-nav__link> <span class=md-ellipsis> MultiGPU API </span> </a> </li> <li class=md-nav__item> <a href=../../api/gguf/ class=md-nav__link> <span class=md-ellipsis> GGUF Tools API </span> </a> </li> <li class=md-nav__item> <a href=../../api/nccl/ class=md-nav__link> <span class=md-ellipsis> NCCL Integration </span> </a> </li> <li class=md-nav__item> <a href=../../api/graphistry/ class=md-nav__link> <span class=md-ellipsis> Graphistry Integration </span> </a> </li> <li class=md-nav__item> <a href=../../api/models/ class=md-nav__link> <span class=md-ellipsis> Models API Reference </span> </a> </li> <li class=md-nav__item> <a href=../../api/examples/ class=md-nav__link> <span class=md-ellipsis> Code Examples </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="On this page"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> On this page </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> ğŸ¯ Overview </span> </a> <nav class=md-nav aria-label="ğŸ¯ Overview"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#why-this-tutorial-is-critical class=md-nav__link> <span class=md-ellipsis> Why This Tutorial is Critical </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#what-youll-visualize class=md-nav__link> <span class=md-ellipsis> ğŸ“Š What You'll Visualize </span> </a> <nav class=md-nav aria-label="ğŸ“Š What You'll Visualize"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#complete-model-architecture class=md-nav__link> <span class=md-ellipsis> Complete Model Architecture </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#architecture-statistics class=md-nav__link> <span class=md-ellipsis> ğŸ—ï¸ Architecture Statistics </span> </a> <nav class=md-nav aria-label="ğŸ—ï¸ Architecture Statistics"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#node-distribution class=md-nav__link> <span class=md-ellipsis> Node Distribution </span> </a> </li> <li class=md-nav__item> <a href=#edge-distribution class=md-nav__link> <span class=md-ellipsis> Edge Distribution </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#visual-components class=md-nav__link> <span class=md-ellipsis> ğŸ¨ Visual Components </span> </a> <nav class=md-nav aria-label="ğŸ¨ Visual Components"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-main-architecture-dashboard-929-nodes class=md-nav__link> <span class=md-ellipsis> 1. Main Architecture Dashboard (929 Nodes) </span> </a> </li> <li class=md-nav__item> <a href=#2-layer-specific-visualizations-layers-1-5 class=md-nav__link> <span class=md-ellipsis> 2. Layer-Specific Visualizations (Layers 1-5) </span> </a> </li> <li class=md-nav__item> <a href=#3-attention-head-analysis-896-nodes class=md-nav__link> <span class=md-ellipsis> 3. Attention Head Analysis (896 Nodes) </span> </a> </li> <li class=md-nav__item> <a href=#4-quantization-block-visualization-112-nodes class=md-nav__link> <span class=md-ellipsis> 4. Quantization Block Visualization (112 Nodes) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#technical-implementation class=md-nav__link> <span class=md-ellipsis> ğŸ”¬ Technical Implementation </span> </a> <nav class=md-nav aria-label="ğŸ”¬ Technical Implementation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#split-gpu-architecture class=md-nav__link> <span class=md-ellipsis> Split-GPU Architecture </span> </a> </li> <li class=md-nav__item> <a href=#data-flow class=md-nav__link> <span class=md-ellipsis> Data Flow </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-by-step-walkthrough class=md-nav__link> <span class=md-ellipsis> ğŸ“ Step-by-Step Walkthrough </span> </a> <nav class=md-nav aria-label="ğŸ“ Step-by-Step Walkthrough"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#part-1-environment-setup-cells-1-10 class=md-nav__link> <span class=md-ellipsis> Part 1: Environment Setup (Cells 1-10) </span> </a> </li> <li class=md-nav__item> <a href=#part-2-model-setup-cells-11-20 class=md-nav__link> <span class=md-ellipsis> Part 2: Model Setup (Cells 11-20) </span> </a> </li> <li class=md-nav__item> <a href=#part-3-architecture-extraction-cells-21-30 class=md-nav__link> <span class=md-ellipsis> Part 3: Architecture Extraction (Cells 21-30) </span> </a> </li> <li class=md-nav__item> <a href=#part-4-gpu-accelerated-analytics-cells-31-40 class=md-nav__link> <span class=md-ellipsis> Part 4: GPU-Accelerated Analytics (Cells 31-40) </span> </a> </li> <li class=md-nav__item> <a href=#part-5-interactive-visualization-cells-41-60 class=md-nav__link> <span class=md-ellipsis> Part 5: Interactive Visualization (Cells 41-60) </span> </a> </li> <li class=md-nav__item> <a href=#part-6-complete-dashboard-export-cells-61-70 class=md-nav__link> <span class=md-ellipsis> Part 6: Complete Dashboard Export (Cells 61-70) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#key-learnings class=md-nav__link> <span class=md-ellipsis> ğŸ“ Key Learnings </span> </a> <nav class=md-nav aria-label="ğŸ“ Key Learnings"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-architecture-insights class=md-nav__link> <span class=md-ellipsis> 1. Architecture Insights </span> </a> </li> <li class=md-nav__item> <a href=#2-quantization-impact class=md-nav__link> <span class=md-ellipsis> 2. Quantization Impact </span> </a> </li> <li class=md-nav__item> <a href=#3-split-gpu-benefits class=md-nav__link> <span class=md-ellipsis> 3. Split-GPU Benefits </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#research-applications class=md-nav__link> <span class=md-ellipsis> ğŸ” Research Applications </span> </a> <nav class=md-nav aria-label="ğŸ” Research Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#model-analysis class=md-nav__link> <span class=md-ellipsis> Model Analysis </span> </a> </li> <li class=md-nav__item> <a href=#optimization class=md-nav__link> <span class=md-ellipsis> Optimization </span> </a> </li> <li class=md-nav__item> <a href=#debugging class=md-nav__link> <span class=md-ellipsis> Debugging </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#outputs class=md-nav__link> <span class=md-ellipsis> ğŸ“ Outputs </span> </a> <nav class=md-nav aria-label="ğŸ“ Outputs"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#files-generated class=md-nav__link> <span class=md-ellipsis> Files Generated </span> </a> </li> <li class=md-nav__item> <a href=#cloud-urls-8-total class=md-nav__link> <span class=md-ellipsis> Cloud URLs (8 total) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#next-steps class=md-nav__link> <span class=md-ellipsis> ğŸš€ Next Steps </span> </a> <nav class=md-nav aria-label="ğŸš€ Next Steps"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#after-completing-this-tutorial class=md-nav__link> <span class=md-ellipsis> After Completing This Tutorial </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> <span class=md-ellipsis> ğŸ› ï¸ Troubleshooting </span> </a> <nav class=md-nav aria-label="ğŸ› ï¸ Troubleshooting"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#common-issues class=md-nav__link> <span class=md-ellipsis> Common Issues </span> </a> </li> <li class=md-nav__item> <a href=#performance-optimization class=md-nav__link> <span class=md-ellipsis> Performance Optimization </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#additional-resources class=md-nav__link> <span class=md-ellipsis> ğŸ“š Additional Resources </span> </a> <nav class=md-nav aria-label="ğŸ“š Additional Resources"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#related-tutorials class=md-nav__link> <span class=md-ellipsis> Related Tutorials </span> </a> </li> <li class=md-nav__item> <a href=#external-documentation class=md-nav__link> <span class=md-ellipsis> External Documentation </span> </a> </li> <li class=md-nav__item> <a href=#academic-papers class=md-nav__link> <span class=md-ellipsis> Academic Papers </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#conclusion class=md-nav__link> <span class=md-ellipsis> ğŸ‰ Conclusion </span> </a> </li> <li class=md-nav__item> <a href=#citation class=md-nav__link> <span class=md-ellipsis> ğŸ“– Citation </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <nav class=md-path aria-label=Navigation> <ol class=md-path__list> <li class=md-path__item> <a href=../.. class=md-path__link> <span class=md-ellipsis> llcuda v2.2.0 </span> </a> </li> <li class=md-path__item> <a href=../../guides/quickstart/ class=md-path__link> <span class=md-ellipsis> Learn </span> </a> </li> <li class=md-path__item> <a href=../ class=md-path__link> <span class=md-ellipsis> Tutorial Notebooks </span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <h1 id=tutorial-11-gguf-neural-network-architecture-visualization>Tutorial 11: GGUF Neural Network Architecture Visualization â­<a class=headerlink href=#tutorial-11-gguf-neural-network-architecture-visualization title="Permanent link">&para;</a></h1> <p><strong>Notebook:</strong> <code>11-gguf-neural-network-graphistry-visualization.ipynb</code> <strong>Difficulty:</strong> Advanced <strong>Time:</strong> 60 minutes <strong>Platform:</strong> Kaggle (2Ã— Tesla T4) <strong>Prerequisites:</strong> Notebooks 01-06</p> <p><a href=https://kaggle.com/code><img alt="Open in Kaggle" src="https://img.shields.io/badge/Kaggle-Open%20Notebook-blue?logo=kaggle"></a></p> <hr> <h2 id=overview>ğŸ¯ Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p>This is the <strong>MOST IMPORTANT</strong> tutorial in the llcuda v2.2.0 series - a groundbreaking tool for visualizing GGUF model internal architecture as interactive graphs using Graphistry. This tutorial represents the pinnacle of the llcuda project, showcasing the split-GPU architecture's full potential.</p> <h3 id=why-this-tutorial-is-critical>Why This Tutorial is Critical<a class=headerlink href=#why-this-tutorial-is-critical title="Permanent link">&para;</a></h3> <ol> <li><strong>First-of-its-Kind</strong>: The only comprehensive GGUF architecture visualization tool available</li> <li><strong>End-to-End Project</strong>: Complete workflow from model loading to interactive dashboards</li> <li><strong>Research-Grade</strong>: Produces publication-quality visualizations and metrics</li> <li><strong>Split-GPU Showcase</strong>: Demonstrates GPU 0 (LLM) + GPU 1 (Visualization) architecture</li> <li><strong>Production-Ready</strong>: Generates downloadable HTML dashboards</li> </ol> <hr> <h2 id=what-youll-visualize>ğŸ“Š What You'll Visualize<a class=headerlink href=#what-youll-visualize title="Permanent link">&para;</a></h2> <h3 id=complete-model-architecture>Complete Model Architecture<a class=headerlink href=#complete-model-architecture title="Permanent link">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>â”‚           GGUF LLAMA-3.2-3B ARCHITECTURE VISUALIZATION          â”‚
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>â”‚                                                                 â”‚
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>â”‚   ğŸ“¥ Input Layer (1 node)                                       â”‚
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>â”‚      â†“                                                          â”‚
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>â”‚   ğŸ”¤ Token Embedding (1 node, 393M parameters)                  â”‚
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>â”‚      â†“                                                          â”‚
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>â”‚   â”‚  ğŸ”„ Transformer Layer 1                         â”‚          â”‚
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>â”‚   â”‚    â”œâ”€ 32 Attention Heads (parallel)             â”‚          â”‚
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>â”‚   â”‚    â”œâ”€ RMSNorm (layer normalization)             â”‚          â”‚
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>â”‚   â”‚    â””â”€ SwiGLU Feed-Forward Network               â”‚          â”‚
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>â”‚      â†“                                                          â”‚
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>â”‚   ... Layers 2-27 (identical structure)                         â”‚
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>â”‚      â†“                                                          â”‚
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a>â”‚   ğŸ”„ Transformer Layer 28 (final layer)                         â”‚
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>â”‚      â†“                                                          â”‚
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a>â”‚   ğŸ“¤ Output Layer (1 node, 393M parameters)                     â”‚
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a>â”‚                                                                 â”‚
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a>â”‚   ğŸ“Š TOTAL: 929 nodes, 981 edges                                â”‚
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a>â”‚   ğŸ’¾ Model Size: 1.88 GB (Q4_K_M quantization)                  â”‚
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a>â”‚   ğŸ§® Parameters: ~2.8 billion                                   â”‚
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a>â”‚                                                                 â”‚
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></code></pre></div> <hr> <h2 id=architecture-statistics>ğŸ—ï¸ Architecture Statistics<a class=headerlink href=#architecture-statistics title="Permanent link">&para;</a></h2> <h3 id=node-distribution>Node Distribution<a class=headerlink href=#node-distribution title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Node Type</th> <th>Count</th> <th>Purpose</th> <th>Memory</th> </tr> </thead> <tbody> <tr> <td><strong>Attention Heads</strong></td> <td>896</td> <td>Multi-head attention (28 layers Ã— 32 heads)</td> <td>~1.2 GB</td> </tr> <tr> <td><strong>Transformer Blocks</strong></td> <td>28</td> <td>Complete transformer layers</td> <td>~1.8 GB total</td> </tr> <tr> <td><strong>Embedding Layer</strong></td> <td>1</td> <td>Token embeddings (128,256 vocab Ã— 3,072 dim)</td> <td>~393 MB</td> </tr> <tr> <td><strong>Output Layer</strong></td> <td>1</td> <td>Output projections</td> <td>~393 MB</td> </tr> <tr> <td><strong>Normalization</strong></td> <td>1</td> <td>Shared RMSNorm across all layers</td> <td>~24 KB</td> </tr> <tr> <td><strong>Feed-Forward</strong></td> <td>1</td> <td>Shared SwiGLU network</td> <td>~113 MB</td> </tr> </tbody> </table> <h3 id=edge-distribution>Edge Distribution<a class=headerlink href=#edge-distribution title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Edge Type</th> <th>Count</th> <th>Meaning</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><code>contains</code></td> <td>896</td> <td>Layer â†’ Attention head relationship</td> <td>Layer_5 â†’ L5_H12</td> </tr> <tr> <td><code>feeds_into</code></td> <td>28</td> <td>Sequential layer connections</td> <td>Layer_1 â†’ Layer_2</td> </tr> <tr> <td><code>uses</code></td> <td>56</td> <td>Layer â†’ Shared component</td> <td>Layer_3 â†’ RMSNorm</td> </tr> <tr> <td><strong>Total Edges</strong></td> <td><strong>981</strong></td> <td>Complete connectivity graph</td> <td>-</td> </tr> </tbody> </table> <hr> <h2 id=visual-components>ğŸ¨ Visual Components<a class=headerlink href=#visual-components title="Permanent link">&para;</a></h2> <h3 id=1-main-architecture-dashboard-929-nodes>1. Main Architecture Dashboard (929 Nodes)<a class=headerlink href=#1-main-architecture-dashboard-929-nodes title="Permanent link">&para;</a></h3> <p>The complete model visualization showing all 28 transformer layers, embeddings, and output projections.</p> <p><strong>Key Features:</strong> - Color-coded by node type (attention=blue, transformer=green, embedding=purple) - Node size proportional to parameter count - Edge thickness indicates connection strength - Interactive zoom, pan, and search</p> <p><strong>Insights Revealed:</strong> - Information flow from input to output - Parameter distribution across layers - Bottlenecks and skip connections - Quantization impact on different components</p> <h3 id=2-layer-specific-visualizations-layers-1-5>2. Layer-Specific Visualizations (Layers 1-5)<a class=headerlink href=#2-layer-specific-visualizations-layers-1-5 title="Permanent link">&para;</a></h3> <p>Five detailed dashboards showing internal structure of individual transformer blocks (35 nodes, 34 edges each).</p> <p><strong>Each Layer Shows:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>Transformer Block Container (1 node)
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>  â”œâ”€ Attention Head 0 (query, key, value, output)
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>  â”œâ”€ Attention Head 1
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>  â”œâ”€ ... (30 more heads)
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>  â”œâ”€ Attention Head 31
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>  â”œâ”€ RMSNorm (shared normalization)
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>  â””â”€ SwiGLU Feed-Forward (shared expansion network)
</span></code></pre></div></p> <p><strong>Why 5 Layers?</strong> - <strong>Layer 1</strong>: First transformer block (after embedding) - <strong>Layer 2</strong>: Second layer (pattern establishing) - <strong>Layer 3</strong>: Mid-early layer (feature building) - <strong>Layer 4</strong>: Mid-layer (representation depth) - <strong>Layer 5</strong>: Shows consistent architecture pattern</p> <h3 id=3-attention-head-analysis-896-nodes>3. Attention Head Analysis (896 Nodes)<a class=headerlink href=#3-attention-head-analysis-896-nodes title="Permanent link">&para;</a></h3> <p>Visualization of all 896 attention heads across 28 layers.</p> <p><strong>Graph Theory Metrics:</strong> - <strong>PageRank</strong>: Identifies most important attention heads - <strong>Betweenness Centrality</strong>: Finds critical information pathways - <strong>Degree Distribution</strong>: Analyzes connectivity patterns</p> <p><strong>Research Applications:</strong> - Identify redundant heads for pruning - Compare head importance across layers - Analyze attention patterns in quantized vs full-precision models</p> <h3 id=4-quantization-block-visualization-112-nodes>4. Quantization Block Visualization (112 Nodes)<a class=headerlink href=#4-quantization-block-visualization-112-nodes title="Permanent link">&para;</a></h3> <p>Shows Q4_K_M quantization structure: 4Ã— super-blocks, each with 8 blocks, each with 32 weights.</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>Super-Block 0 (512 weights)
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>  â”œâ”€ Block 0 (32 weights, quantized)
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>  â”œâ”€ Block 1 (32 weights, quantized)
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>  â”œâ”€ ... (6 more blocks)
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>  â””â”€ Block 7 (32 weights, quantized)
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>... (3 more super-blocks)
</span></code></pre></div> <hr> <h2 id=technical-implementation>ğŸ”¬ Technical Implementation<a class=headerlink href=#technical-implementation title="Permanent link">&para;</a></h2> <h3 id=split-gpu-architecture>Split-GPU Architecture<a class=headerlink href=#split-gpu-architecture title="Permanent link">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>â”‚                    DUAL T4 GPU ALLOCATION                        â”‚
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>â”‚                                                                 â”‚
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>â”‚   GPU 0: Tesla T4 (15GB VRAM) - LLM INFERENCE                   â”‚
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>â”‚   â”œâ”€ llama-server process                                       â”‚
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>â”‚   â”œâ”€ Model: Llama-3.2-3B-Q4_K_M                                 â”‚
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>â”‚   â”œâ”€ VRAM Usage: ~3.5 GB                                        â”‚
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>â”‚   â”œâ”€ tensor_split: &quot;1.0,0.0&quot; (100% GPU 0)                       â”‚
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>â”‚   â””â”€ Available for queries: Yes                                 â”‚
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>â”‚                                                                 â”‚
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a>â”‚   GPU 1: Tesla T4 (15GB VRAM) - VISUALIZATION                   â”‚
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a>â”‚   â”œâ”€ RAPIDS cuGraph (PageRank computation)                      â”‚
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a>â”‚   â”œâ”€ Graphistry (interactive rendering)                         â”‚
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a>â”‚   â”œâ”€ VRAM Usage: ~0.8 GB                                        â”‚
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a>â”‚   â””â”€ Available VRAM: ~14 GB                                     â”‚
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a>â”‚                                                                 â”‚
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></code></pre></div> <h3 id=data-flow>Data Flow<a class=headerlink href=#data-flow title="Permanent link">&para;</a></h3> <ol> <li><strong>Architecture Extraction</strong> (GPU 0)</li> <li>Query llama-server for model metadata</li> <li>Extract layer count, head count, dimensions</li> <li> <p>Build architectural graph representation</p> </li> <li> <p><strong>Graph Construction</strong> (CPU)</p> </li> <li>Create nodes for each component</li> <li>Define edges (contains, feeds_into, uses)</li> <li> <p>Calculate node properties (params, memory)</p> </li> <li> <p><strong>Graph Analytics</strong> (GPU 1)</p> </li> <li>Load graph into cuGraph (GPU-accelerated)</li> <li>Compute PageRank (identify important nodes)</li> <li>Calculate centrality metrics</li> <li> <p>Perform community detection</p> </li> <li> <p><strong>Visualization</strong> (GPU 1)</p> </li> <li>Upload to Graphistry cloud</li> <li>Generate interactive HTML dashboards</li> <li>Create downloadable artifacts</li> </ol> <hr> <h2 id=step-by-step-walkthrough>ğŸ“ Step-by-Step Walkthrough<a class=headerlink href=#step-by-step-walkthrough title="Permanent link">&para;</a></h2> <h3 id=part-1-environment-setup-cells-1-10>Part 1: Environment Setup (Cells 1-10)<a class=headerlink href=#part-1-environment-setup-cells-1-10 title="Permanent link">&para;</a></h3> <p><strong>Cell 1-3: GPU Verification</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=err>!</span><span class=n>nvidia</span><span class=o>-</span><span class=n>smi</span> <span class=o>--</span><span class=n>query</span><span class=o>-</span><span class=n>gpu</span><span class=o>=</span><span class=n>index</span><span class=p>,</span><span class=n>name</span><span class=p>,</span><span class=n>memory</span><span class=o>.</span><span class=n>total</span><span class=p>,</span><span class=n>compute_cap</span> <span class=o>--</span><span class=nb>format</span><span class=o>=</span><span class=n>csv</span>
</span></code></pre></div></p> <p><strong>Expected Output:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>index, name, memory.total [MiB], compute_cap
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>0, Tesla T4, 15360 MiB, 7.5
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>1, Tesla T4, 15360 MiB, 7.5
</span></code></pre></div></p> <p><strong>Cell 11: Install llcuda v2.2.0</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>!pip<span class=w> </span>install<span class=w> </span>-q<span class=w> </span>--no-cache-dir<span class=w> </span>--force-reinstall<span class=w> </span><span class=se>\</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=w>  </span>git+https://github.com/llcuda/llcuda.git@v2.2.0
</span></code></pre></div></p> <hr> <h3 id=part-2-model-setup-cells-11-20>Part 2: Model Setup (Cells 11-20)<a class=headerlink href=#part-2-model-setup-cells-11-20 title="Permanent link">&para;</a></h3> <p><strong>Cell 16: Download GGUF Model</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=kn>from</span><span class=w> </span><span class=nn>huggingface_hub</span><span class=w> </span><span class=kn>import</span> <span class=n>hf_hub_download</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=n>model_path</span> <span class=o>=</span> <span class=n>hf_hub_download</span><span class=p>(</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>    <span class=n>repo_id</span><span class=o>=</span><span class=s2>&quot;bartowski/Llama-3.2-3B-Instruct-GGUF&quot;</span><span class=p>,</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>    <span class=n>filename</span><span class=o>=</span><span class=s2>&quot;Llama-3.2-3B-Instruct-Q4_K_M.gguf&quot;</span><span class=p>,</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>    <span class=n>local_dir</span><span class=o>=</span><span class=s2>&quot;/kaggle/working/models&quot;</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=p>)</span>
</span></code></pre></div></p> <p><strong>Model Specifications:</strong> - Size: 1.88 GB - Quantization: Q4_K_M (mixed 4-bit/6-bit) - Context: 131,072 tokens (128K) - Vocabulary: 128,256 tokens</p> <p><strong>Cell 18: Start llama-server on GPU 0</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=kn>from</span><span class=w> </span><span class=nn>llcuda.server</span><span class=w> </span><span class=kn>import</span> <span class=n>ServerManager</span><span class=p>,</span> <span class=n>ServerConfig</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=n>config</span> <span class=o>=</span> <span class=n>ServerConfig</span><span class=p>(</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>    <span class=n>model_path</span><span class=o>=</span><span class=n>model_path</span><span class=p>,</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>    <span class=n>n_gpu_layers</span><span class=o>=</span><span class=mi>99</span><span class=p>,</span>              <span class=c1># Load all layers to GPU</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>    <span class=n>tensor_split</span><span class=o>=</span><span class=s2>&quot;1.0,0.0&quot;</span><span class=p>,</span>       <span class=c1># 100% GPU 0, 0% GPU 1</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>    <span class=n>flash_attn</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>                 <span class=c1># Enable FlashAttention</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>    <span class=n>n_ctx</span><span class=o>=</span><span class=mi>4096</span><span class=p>,</span>                   <span class=c1># Context window</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>    <span class=n>host</span><span class=o>=</span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>    <span class=n>port</span><span class=o>=</span><span class=mi>8080</span><span class=p>,</span>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=p>)</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=n>server</span> <span class=o>=</span> <span class=n>ServerManager</span><span class=p>()</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=n>server</span><span class=o>.</span><span class=n>start_with_config</span><span class=p>(</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a><span class=n>server</span><span class=o>.</span><span class=n>wait_until_ready</span><span class=p>(</span><span class=n>timeout</span><span class=o>=</span><span class=mi>120</span><span class=p>)</span>
</span></code></pre></div></p> <hr> <h3 id=part-3-architecture-extraction-cells-21-30>Part 3: Architecture Extraction (Cells 21-30)<a class=headerlink href=#part-3-architecture-extraction-cells-21-30 title="Permanent link">&para;</a></h3> <p><strong>Cell 24: Query Model Metadata</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=kn>from</span><span class=w> </span><span class=nn>llcuda.api</span><span class=w> </span><span class=kn>import</span> <span class=n>LlamaCppClient</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=n>client</span> <span class=o>=</span> <span class=n>LlamaCppClient</span><span class=p>(</span><span class=n>base_url</span><span class=o>=</span><span class=s2>&quot;http://127.0.0.1:8080&quot;</span><span class=p>)</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=c1># Get model architecture</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=n>metadata</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>get_model_metadata</span><span class=p>()</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Model: </span><span class=si>{</span><span class=n>metadata</span><span class=p>[</span><span class=s1>&#39;general.name&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Layers: </span><span class=si>{</span><span class=n>metadata</span><span class=p>[</span><span class=s1>&#39;llama.block_count&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Attention Heads: </span><span class=si>{</span><span class=n>metadata</span><span class=p>[</span><span class=s1>&#39;llama.attention.head_count&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Embedding Dimension: </span><span class=si>{</span><span class=n>metadata</span><span class=p>[</span><span class=s1>&#39;llama.embedding_length&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Vocabulary Size: </span><span class=si>{</span><span class=n>metadata</span><span class=p>[</span><span class=s1>&#39;tokenizer.ggml.token_count&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div></p> <p><strong>Expected Output:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>Model: Llama-3.2-3B-Instruct
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>Layers: 28
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>Attention Heads: 32
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>Embedding Dimension: 3072
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>Vocabulary Size: 128256
</span></code></pre></div></p> <p><strong>Cell 28: Build Architecture Graph</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=kn>import</span><span class=w> </span><span class=nn>networkx</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>nx</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=c1># Create graph</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=n>G</span> <span class=o>=</span> <span class=n>nx</span><span class=o>.</span><span class=n>DiGraph</span><span class=p>()</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=c1># Add input node</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=n>G</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=s2>&quot;Input&quot;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;input&quot;</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=c1># Add embedding layer</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=n>embedding_params</span> <span class=o>=</span> <span class=n>vocab_size</span> <span class=o>*</span> <span class=n>embedding_dim</span>
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a><span class=n>G</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=s2>&quot;Embedding&quot;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;embedding&quot;</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>embedding_params</span><span class=p>)</span>
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a><span class=n>G</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=s2>&quot;Input&quot;</span><span class=p>,</span> <span class=s2>&quot;Embedding&quot;</span><span class=p>,</span> <span class=n>relationship</span><span class=o>=</span><span class=s2>&quot;feeds_into&quot;</span><span class=p>)</span>
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a>
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a><span class=c1># Add transformer layers</span>
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a><span class=k>for</span> <span class=n>layer_idx</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>num_layers</span><span class=p>):</span>
</span><span id=__span-11-17><a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a>    <span class=n>layer_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;Layer_</span><span class=si>{</span><span class=n>layer_idx</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-11-18><a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a>
</span><span id=__span-11-19><a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a>    <span class=c1># Add layer node</span>
</span><span id=__span-11-20><a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a>    <span class=n>G</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=n>layer_name</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;transformer&quot;</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>layer_params</span><span class=p>)</span>
</span><span id=__span-11-21><a id=__codelineno-11-21 name=__codelineno-11-21 href=#__codelineno-11-21></a>
</span><span id=__span-11-22><a id=__codelineno-11-22 name=__codelineno-11-22 href=#__codelineno-11-22></a>    <span class=c1># Add attention heads</span>
</span><span id=__span-11-23><a id=__codelineno-11-23 name=__codelineno-11-23 href=#__codelineno-11-23></a>    <span class=k>for</span> <span class=n>head_idx</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>num_heads</span><span class=p>):</span>
</span><span id=__span-11-24><a id=__codelineno-11-24 name=__codelineno-11-24 href=#__codelineno-11-24></a>        <span class=n>head_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;L</span><span class=si>{</span><span class=n>layer_idx</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=si>}</span><span class=s2>_H</span><span class=si>{</span><span class=n>head_idx</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-11-25><a id=__codelineno-11-25 name=__codelineno-11-25 href=#__codelineno-11-25></a>        <span class=n>G</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=n>head_name</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;attention_head&quot;</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>head_params</span><span class=p>)</span>
</span><span id=__span-11-26><a id=__codelineno-11-26 name=__codelineno-11-26 href=#__codelineno-11-26></a>        <span class=n>G</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=n>layer_name</span><span class=p>,</span> <span class=n>head_name</span><span class=p>,</span> <span class=n>relationship</span><span class=o>=</span><span class=s2>&quot;contains&quot;</span><span class=p>)</span>
</span><span id=__span-11-27><a id=__codelineno-11-27 name=__codelineno-11-27 href=#__codelineno-11-27></a>
</span><span id=__span-11-28><a id=__codelineno-11-28 name=__codelineno-11-28 href=#__codelineno-11-28></a>    <span class=c1># Connect to shared components</span>
</span><span id=__span-11-29><a id=__codelineno-11-29 name=__codelineno-11-29 href=#__codelineno-11-29></a>    <span class=n>G</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=n>layer_name</span><span class=p>,</span> <span class=s2>&quot;LayerNorm&quot;</span><span class=p>,</span> <span class=n>relationship</span><span class=o>=</span><span class=s2>&quot;uses&quot;</span><span class=p>)</span>
</span><span id=__span-11-30><a id=__codelineno-11-30 name=__codelineno-11-30 href=#__codelineno-11-30></a>    <span class=n>G</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=n>layer_name</span><span class=p>,</span> <span class=s2>&quot;FeedForward&quot;</span><span class=p>,</span> <span class=n>relationship</span><span class=o>=</span><span class=s2>&quot;uses&quot;</span><span class=p>)</span>
</span><span id=__span-11-31><a id=__codelineno-11-31 name=__codelineno-11-31 href=#__codelineno-11-31></a>
</span><span id=__span-11-32><a id=__codelineno-11-32 name=__codelineno-11-32 href=#__codelineno-11-32></a>    <span class=c1># Sequential connection</span>
</span><span id=__span-11-33><a id=__codelineno-11-33 name=__codelineno-11-33 href=#__codelineno-11-33></a>    <span class=k>if</span> <span class=n>layer_idx</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-11-34><a id=__codelineno-11-34 name=__codelineno-11-34 href=#__codelineno-11-34></a>        <span class=n>prev_layer</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;Layer_</span><span class=si>{</span><span class=n>layer_idx</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-11-35><a id=__codelineno-11-35 name=__codelineno-11-35 href=#__codelineno-11-35></a>        <span class=n>G</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=n>prev_layer</span><span class=p>,</span> <span class=n>layer_name</span><span class=p>,</span> <span class=n>relationship</span><span class=o>=</span><span class=s2>&quot;feeds_into&quot;</span><span class=p>)</span>
</span><span id=__span-11-36><a id=__codelineno-11-36 name=__codelineno-11-36 href=#__codelineno-11-36></a>
</span><span id=__span-11-37><a id=__codelineno-11-37 name=__codelineno-11-37 href=#__codelineno-11-37></a><span class=c1># Add output layer</span>
</span><span id=__span-11-38><a id=__codelineno-11-38 name=__codelineno-11-38 href=#__codelineno-11-38></a><span class=n>G</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=s2>&quot;Output&quot;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;output&quot;</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>embedding_params</span><span class=p>)</span>
</span><span id=__span-11-39><a id=__codelineno-11-39 name=__codelineno-11-39 href=#__codelineno-11-39></a><span class=n>G</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Layer_</span><span class=si>{</span><span class=n>num_layers</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s2>&quot;Output&quot;</span><span class=p>,</span> <span class=n>relationship</span><span class=o>=</span><span class=s2>&quot;feeds_into&quot;</span><span class=p>)</span>
</span><span id=__span-11-40><a id=__codelineno-11-40 name=__codelineno-11-40 href=#__codelineno-11-40></a>
</span><span id=__span-11-41><a id=__codelineno-11-41 name=__codelineno-11-41 href=#__codelineno-11-41></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Graph created: </span><span class=si>{</span><span class=n>G</span><span class=o>.</span><span class=n>number_of_nodes</span><span class=p>()</span><span class=si>}</span><span class=s2> nodes, </span><span class=si>{</span><span class=n>G</span><span class=o>.</span><span class=n>number_of_edges</span><span class=p>()</span><span class=si>}</span><span class=s2> edges&quot;</span><span class=p>)</span>
</span></code></pre></div></p> <hr> <h3 id=part-4-gpu-accelerated-analytics-cells-31-40>Part 4: GPU-Accelerated Analytics (Cells 31-40)<a class=headerlink href=#part-4-gpu-accelerated-analytics-cells-31-40 title="Permanent link">&para;</a></h3> <p><strong>Cell 33: Install RAPIDS cuGraph</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>!pip<span class=w> </span>install<span class=w> </span>-q<span class=w> </span>cugraph-cu12
</span></code></pre></div></p> <p><strong>Cell 36: Compute PageRank on GPU 1</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=kn>import</span><span class=w> </span><span class=nn>cudf</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=kn>import</span><span class=w> </span><span class=nn>cugraph</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=c1># Convert NetworkX to cuGraph</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=n>edges_df</span> <span class=o>=</span> <span class=n>cudf</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>    <span class=s1>&#39;src&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>edge</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=k>for</span> <span class=n>edge</span> <span class=ow>in</span> <span class=n>G</span><span class=o>.</span><span class=n>edges</span><span class=p>()],</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a>    <span class=s1>&#39;dst&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>edge</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>for</span> <span class=n>edge</span> <span class=ow>in</span> <span class=n>G</span><span class=o>.</span><span class=n>edges</span><span class=p>()]</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=p>})</span>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>
</span><span id=__span-13-10><a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=n>cu_graph</span> <span class=o>=</span> <span class=n>cugraph</span><span class=o>.</span><span class=n>Graph</span><span class=p>(</span><span class=n>directed</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-13-11><a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=n>cu_graph</span><span class=o>.</span><span class=n>from_cudf_edgelist</span><span class=p>(</span><span class=n>edges_df</span><span class=p>,</span> <span class=n>source</span><span class=o>=</span><span class=s1>&#39;src&#39;</span><span class=p>,</span> <span class=n>destination</span><span class=o>=</span><span class=s1>&#39;dst&#39;</span><span class=p>)</span>
</span><span id=__span-13-12><a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a>
</span><span id=__span-13-13><a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a><span class=c1># Compute PageRank (GPU-accelerated)</span>
</span><span id=__span-13-14><a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a><span class=n>pagerank_df</span> <span class=o>=</span> <span class=n>cugraph</span><span class=o>.</span><span class=n>pagerank</span><span class=p>(</span><span class=n>cu_graph</span><span class=p>)</span>
</span><span id=__span-13-15><a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a>
</span><span id=__span-13-16><a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a><span class=c1># Convert back to pandas</span>
</span><span id=__span-13-17><a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a><span class=n>pr_dict</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=n>pagerank_df</span><span class=p>[</span><span class=s1>&#39;vertex&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>to_pandas</span><span class=p>(),</span>
</span><span id=__span-13-18><a id=__codelineno-13-18 name=__codelineno-13-18 href=#__codelineno-13-18></a>                   <span class=n>pagerank_df</span><span class=p>[</span><span class=s1>&#39;pagerank&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>to_pandas</span><span class=p>()))</span>
</span><span id=__span-13-19><a id=__codelineno-13-19 name=__codelineno-13-19 href=#__codelineno-13-19></a>
</span><span id=__span-13-20><a id=__codelineno-13-20 name=__codelineno-13-20 href=#__codelineno-13-20></a><span class=c1># Add to graph</span>
</span><span id=__span-13-21><a id=__codelineno-13-21 name=__codelineno-13-21 href=#__codelineno-13-21></a><span class=n>nx</span><span class=o>.</span><span class=n>set_node_attributes</span><span class=p>(</span><span class=n>G</span><span class=p>,</span> <span class=n>pr_dict</span><span class=p>,</span> <span class=s1>&#39;pagerank&#39;</span><span class=p>)</span>
</span><span id=__span-13-22><a id=__codelineno-13-22 name=__codelineno-13-22 href=#__codelineno-13-22></a>
</span><span id=__span-13-23><a id=__codelineno-13-23 name=__codelineno-13-23 href=#__codelineno-13-23></a><span class=c1># Find top 10 most important nodes</span>
</span><span id=__span-13-24><a id=__codelineno-13-24 name=__codelineno-13-24 href=#__codelineno-13-24></a><span class=n>top_nodes</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>pr_dict</span><span class=o>.</span><span class=n>items</span><span class=p>(),</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)[:</span><span class=mi>10</span><span class=p>]</span>
</span><span id=__span-13-25><a id=__codelineno-13-25 name=__codelineno-13-25 href=#__codelineno-13-25></a><span class=k>for</span> <span class=n>node</span><span class=p>,</span> <span class=n>score</span> <span class=ow>in</span> <span class=n>top_nodes</span><span class=p>:</span>
</span><span id=__span-13-26><a id=__codelineno-13-26 name=__codelineno-13-26 href=#__codelineno-13-26></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>node</span><span class=si>}</span><span class=s2>: PageRank = </span><span class=si>{</span><span class=n>score</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div></p> <p><strong>Expected Top Nodes:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a>Embedding: PageRank = 0.045231
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>Layer_14: PageRank = 0.038912
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>Layer_15: PageRank = 0.037654
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>L14_H16: PageRank = 0.023445
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>Output: PageRank = 0.022876
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>...
</span></code></pre></div></p> <hr> <h3 id=part-5-interactive-visualization-cells-41-60>Part 5: Interactive Visualization (Cells 41-60)<a class=headerlink href=#part-5-interactive-visualization-cells-41-60 title="Permanent link">&para;</a></h3> <p><strong>Cell 45: Install Graphistry</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>!pip<span class=w> </span>install<span class=w> </span>-q<span class=w> </span>graphistry<span class=o>[</span>all<span class=o>]</span>
</span></code></pre></div></p> <p><strong>Cell 48: Create Main Architecture Dashboard</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=kn>import</span><span class=w> </span><span class=nn>graphistry</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=c1># Register with Graphistry (free tier)</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=n>graphistry</span><span class=o>.</span><span class=n>register</span><span class=p>(</span><span class=n>api</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>protocol</span><span class=o>=</span><span class=s2>&quot;https&quot;</span><span class=p>,</span> <span class=n>server</span><span class=o>=</span><span class=s2>&quot;hub.graphistry.com&quot;</span><span class=p>)</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=c1># Prepare data for Graphistry</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=n>nodes_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([</span>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>    <span class=p>{</span>
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>        <span class=s1>&#39;node&#39;</span><span class=p>:</span> <span class=n>node</span><span class=p>,</span>
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a>        <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;type&#39;</span><span class=p>,</span> <span class=s1>&#39;unknown&#39;</span><span class=p>),</span>
</span><span id=__span-16-11><a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a>        <span class=s1>&#39;params&#39;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;params&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span>
</span><span id=__span-16-12><a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a>        <span class=s1>&#39;pagerank&#39;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;pagerank&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span>
</span><span id=__span-16-13><a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a>        <span class=s1>&#39;label&#39;</span><span class=p>:</span> <span class=n>node</span><span class=p>,</span>
</span><span id=__span-16-14><a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a>    <span class=p>}</span>
</span><span id=__span-16-15><a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a>    <span class=k>for</span> <span class=n>node</span><span class=p>,</span> <span class=n>data</span> <span class=ow>in</span> <span class=n>G</span><span class=o>.</span><span class=n>nodes</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-16-16><a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a><span class=p>])</span>
</span><span id=__span-16-17><a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a>
</span><span id=__span-16-18><a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a><span class=n>edges_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([</span>
</span><span id=__span-16-19><a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a>    <span class=p>{</span>
</span><span id=__span-16-20><a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a>        <span class=s1>&#39;src&#39;</span><span class=p>:</span> <span class=n>src</span><span class=p>,</span>
</span><span id=__span-16-21><a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a>        <span class=s1>&#39;dst&#39;</span><span class=p>:</span> <span class=n>dst</span><span class=p>,</span>
</span><span id=__span-16-22><a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a>        <span class=s1>&#39;relationship&#39;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;relationship&#39;</span><span class=p>,</span> <span class=s1>&#39;unknown&#39;</span><span class=p>),</span>
</span><span id=__span-16-23><a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a>    <span class=p>}</span>
</span><span id=__span-16-24><a id=__codelineno-16-24 name=__codelineno-16-24 href=#__codelineno-16-24></a>    <span class=k>for</span> <span class=n>src</span><span class=p>,</span> <span class=n>dst</span><span class=p>,</span> <span class=n>data</span> <span class=ow>in</span> <span class=n>G</span><span class=o>.</span><span class=n>edges</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-16-25><a id=__codelineno-16-25 name=__codelineno-16-25 href=#__codelineno-16-25></a><span class=p>])</span>
</span><span id=__span-16-26><a id=__codelineno-16-26 name=__codelineno-16-26 href=#__codelineno-16-26></a>
</span><span id=__span-16-27><a id=__codelineno-16-27 name=__codelineno-16-27 href=#__codelineno-16-27></a><span class=c1># Create Graphistry visualization</span>
</span><span id=__span-16-28><a id=__codelineno-16-28 name=__codelineno-16-28 href=#__codelineno-16-28></a><span class=n>g</span> <span class=o>=</span> <span class=n>graphistry</span><span class=o>.</span><span class=n>edges</span><span class=p>(</span><span class=n>edges_df</span><span class=p>,</span> <span class=s1>&#39;src&#39;</span><span class=p>,</span> <span class=s1>&#39;dst&#39;</span><span class=p>)</span> \
</span><span id=__span-16-29><a id=__codelineno-16-29 name=__codelineno-16-29 href=#__codelineno-16-29></a>               <span class=o>.</span><span class=n>nodes</span><span class=p>(</span><span class=n>nodes_df</span><span class=p>,</span> <span class=s1>&#39;node&#39;</span><span class=p>)</span> \
</span><span id=__span-16-30><a id=__codelineno-16-30 name=__codelineno-16-30 href=#__codelineno-16-30></a>               <span class=o>.</span><span class=n>bind</span><span class=p>(</span><span class=n>node</span><span class=o>=</span><span class=s1>&#39;node&#39;</span><span class=p>,</span>
</span><span id=__span-16-31><a id=__codelineno-16-31 name=__codelineno-16-31 href=#__codelineno-16-31></a>                     <span class=n>point_title</span><span class=o>=</span><span class=s1>&#39;label&#39;</span><span class=p>,</span>
</span><span id=__span-16-32><a id=__codelineno-16-32 name=__codelineno-16-32 href=#__codelineno-16-32></a>                     <span class=n>point_size</span><span class=o>=</span><span class=s1>&#39;params&#39;</span><span class=p>,</span>
</span><span id=__span-16-33><a id=__codelineno-16-33 name=__codelineno-16-33 href=#__codelineno-16-33></a>                     <span class=n>point_color</span><span class=o>=</span><span class=s1>&#39;type&#39;</span><span class=p>,</span>
</span><span id=__span-16-34><a id=__codelineno-16-34 name=__codelineno-16-34 href=#__codelineno-16-34></a>                     <span class=n>edge_title</span><span class=o>=</span><span class=s1>&#39;relationship&#39;</span><span class=p>)</span>
</span><span id=__span-16-35><a id=__codelineno-16-35 name=__codelineno-16-35 href=#__codelineno-16-35></a>
</span><span id=__span-16-36><a id=__codelineno-16-36 name=__codelineno-16-36 href=#__codelineno-16-36></a><span class=c1># Upload and get URL</span>
</span><span id=__span-16-37><a id=__codelineno-16-37 name=__codelineno-16-37 href=#__codelineno-16-37></a><span class=n>url</span> <span class=o>=</span> <span class=n>g</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>render</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-16-38><a id=__codelineno-16-38 name=__codelineno-16-38 href=#__codelineno-16-38></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Main Architecture Dashboard: </span><span class=si>{</span><span class=n>url</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div></p> <p><strong>Cell 52-58: Create Layer-Specific Dashboards</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=c1># Visualize Layers 1-5 individually</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=k>for</span> <span class=n>layer_num</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>6</span><span class=p>):</span>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a>    <span class=n>layer_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;Layer_</span><span class=si>{</span><span class=n>layer_num</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a>    <span class=c1># Extract subgraph for this layer</span>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>    <span class=n>layer_nodes</span> <span class=o>=</span> <span class=p>[</span><span class=n>layer_name</span><span class=p>]</span>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a>    <span class=n>layer_nodes</span> <span class=o>+=</span> <span class=p>[</span><span class=n>n</span> <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=n>G</span><span class=o>.</span><span class=n>nodes</span><span class=p>()</span> <span class=k>if</span> <span class=n>n</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;L</span><span class=si>{</span><span class=n>layer_num</span><span class=si>}</span><span class=s2>_H&quot;</span><span class=p>)]</span>
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>    <span class=n>layer_nodes</span> <span class=o>+=</span> <span class=p>[</span><span class=s2>&quot;LayerNorm&quot;</span><span class=p>,</span> <span class=s2>&quot;FeedForward&quot;</span><span class=p>]</span>
</span><span id=__span-17-9><a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a>
</span><span id=__span-17-10><a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a>    <span class=n>subgraph</span> <span class=o>=</span> <span class=n>G</span><span class=o>.</span><span class=n>subgraph</span><span class=p>(</span><span class=n>layer_nodes</span><span class=p>)</span>
</span><span id=__span-17-11><a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a>
</span><span id=__span-17-12><a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a>    <span class=c1># Create visualization</span>
</span><span id=__span-17-13><a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a>    <span class=n>sub_nodes_df</span> <span class=o>=</span> <span class=n>nodes_df</span><span class=p>[</span><span class=n>nodes_df</span><span class=p>[</span><span class=s1>&#39;node&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>layer_nodes</span><span class=p>)]</span>
</span><span id=__span-17-14><a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a>    <span class=n>sub_edges_df</span> <span class=o>=</span> <span class=n>edges_df</span><span class=p>[</span>
</span><span id=__span-17-15><a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a>        <span class=p>(</span><span class=n>edges_df</span><span class=p>[</span><span class=s1>&#39;src&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>layer_nodes</span><span class=p>))</span> <span class=o>&amp;</span>
</span><span id=__span-17-16><a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a>        <span class=p>(</span><span class=n>edges_df</span><span class=p>[</span><span class=s1>&#39;dst&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>layer_nodes</span><span class=p>))</span>
</span><span id=__span-17-17><a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a>    <span class=p>]</span>
</span><span id=__span-17-18><a id=__codelineno-17-18 name=__codelineno-17-18 href=#__codelineno-17-18></a>
</span><span id=__span-17-19><a id=__codelineno-17-19 name=__codelineno-17-19 href=#__codelineno-17-19></a>    <span class=n>g_layer</span> <span class=o>=</span> <span class=n>graphistry</span><span class=o>.</span><span class=n>edges</span><span class=p>(</span><span class=n>sub_edges_df</span><span class=p>,</span> <span class=s1>&#39;src&#39;</span><span class=p>,</span> <span class=s1>&#39;dst&#39;</span><span class=p>)</span> \
</span><span id=__span-17-20><a id=__codelineno-17-20 name=__codelineno-17-20 href=#__codelineno-17-20></a>                        <span class=o>.</span><span class=n>nodes</span><span class=p>(</span><span class=n>sub_nodes_df</span><span class=p>,</span> <span class=s1>&#39;node&#39;</span><span class=p>)</span> \
</span><span id=__span-17-21><a id=__codelineno-17-21 name=__codelineno-17-21 href=#__codelineno-17-21></a>                        <span class=o>.</span><span class=n>bind</span><span class=p>(</span><span class=n>node</span><span class=o>=</span><span class=s1>&#39;node&#39;</span><span class=p>,</span>
</span><span id=__span-17-22><a id=__codelineno-17-22 name=__codelineno-17-22 href=#__codelineno-17-22></a>                              <span class=n>point_title</span><span class=o>=</span><span class=s1>&#39;label&#39;</span><span class=p>,</span>
</span><span id=__span-17-23><a id=__codelineno-17-23 name=__codelineno-17-23 href=#__codelineno-17-23></a>                              <span class=n>point_size</span><span class=o>=</span><span class=s1>&#39;params&#39;</span><span class=p>,</span>
</span><span id=__span-17-24><a id=__codelineno-17-24 name=__codelineno-17-24 href=#__codelineno-17-24></a>                              <span class=n>point_color</span><span class=o>=</span><span class=s1>&#39;type&#39;</span><span class=p>)</span>
</span><span id=__span-17-25><a id=__codelineno-17-25 name=__codelineno-17-25 href=#__codelineno-17-25></a>
</span><span id=__span-17-26><a id=__codelineno-17-26 name=__codelineno-17-26 href=#__codelineno-17-26></a>    <span class=n>url</span> <span class=o>=</span> <span class=n>g_layer</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>render</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-17-27><a id=__codelineno-17-27 name=__codelineno-17-27 href=#__codelineno-17-27></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Layer </span><span class=si>{</span><span class=n>layer_num</span><span class=si>}</span><span class=s2> Dashboard (35 nodes, 34 edges): </span><span class=si>{</span><span class=n>url</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div></p> <hr> <h3 id=part-6-complete-dashboard-export-cells-61-70>Part 6: Complete Dashboard Export (Cells 61-70)<a class=headerlink href=#part-6-complete-dashboard-export-cells-61-70 title="Permanent link">&para;</a></h3> <p><strong>Cell 65: Generate All-in-One HTML Dashboard</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=c1># Create comprehensive dashboard with all visualizations</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=n>html_content</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=s2>&lt;!DOCTYPE html&gt;</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=s2>&lt;html&gt;</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=s2>&lt;head&gt;</span>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=s2>    &lt;title&gt;GGUF Llama-3.2-3B Architecture Visualization&lt;/title&gt;</span>
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=s2>    &lt;style&gt;</span>
</span><span id=__span-18-8><a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=s2>        body </span><span class=se>{{</span><span class=s2> font-family: Arial, sans-serif; margin: 20px; </span><span class=se>}}</span>
</span><span id=__span-18-9><a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=s2>        .visualization </span><span class=se>{{</span><span class=s2> margin: 30px 0; padding: 20px; border: 1px solid #ccc; </span><span class=se>}}</span>
</span><span id=__span-18-10><a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a><span class=s2>        h1 </span><span class=se>{{</span><span class=s2> color: #333; </span><span class=se>}}</span>
</span><span id=__span-18-11><a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a><span class=s2>        h2 </span><span class=se>{{</span><span class=s2> color: #666; </span><span class=se>}}</span>
</span><span id=__span-18-12><a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a><span class=s2>        .stats </span><span class=se>{{</span><span class=s2> background: #f0f0f0; padding: 15px; margin: 15px 0; </span><span class=se>}}</span>
</span><span id=__span-18-13><a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a><span class=s2>        iframe </span><span class=se>{{</span><span class=s2> width: 100%; height: 800px; border: 1px solid #ddd; </span><span class=se>}}</span>
</span><span id=__span-18-14><a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a><span class=s2>    &lt;/style&gt;</span>
</span><span id=__span-18-15><a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a><span class=s2>&lt;/head&gt;</span>
</span><span id=__span-18-16><a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a><span class=s2>&lt;body&gt;</span>
</span><span id=__span-18-17><a id=__codelineno-18-17 name=__codelineno-18-17 href=#__codelineno-18-17></a><span class=s2>    &lt;h1&gt;ğŸ§  GGUF Neural Network Architecture Visualization&lt;/h1&gt;</span>
</span><span id=__span-18-18><a id=__codelineno-18-18 name=__codelineno-18-18 href=#__codelineno-18-18></a>
</span><span id=__span-18-19><a id=__codelineno-18-19 name=__codelineno-18-19 href=#__codelineno-18-19></a><span class=s2>    &lt;div class=&quot;stats&quot;&gt;</span>
</span><span id=__span-18-20><a id=__codelineno-18-20 name=__codelineno-18-20 href=#__codelineno-18-20></a><span class=s2>        &lt;h2&gt;ğŸ“Š Model Statistics&lt;/h2&gt;</span>
</span><span id=__span-18-21><a id=__codelineno-18-21 name=__codelineno-18-21 href=#__codelineno-18-21></a><span class=s2>        &lt;ul&gt;</span>
</span><span id=__span-18-22><a id=__codelineno-18-22 name=__codelineno-18-22 href=#__codelineno-18-22></a><span class=s2>            &lt;li&gt;&lt;strong&gt;Model:&lt;/strong&gt; Llama-3.2-3B-Instruct&lt;/li&gt;</span>
</span><span id=__span-18-23><a id=__codelineno-18-23 name=__codelineno-18-23 href=#__codelineno-18-23></a><span class=s2>            &lt;li&gt;&lt;strong&gt;Quantization:&lt;/strong&gt; Q4_K_M&lt;/li&gt;</span>
</span><span id=__span-18-24><a id=__codelineno-18-24 name=__codelineno-18-24 href=#__codelineno-18-24></a><span class=s2>            &lt;li&gt;&lt;strong&gt;Total Nodes:&lt;/strong&gt; 929&lt;/li&gt;</span>
</span><span id=__span-18-25><a id=__codelineno-18-25 name=__codelineno-18-25 href=#__codelineno-18-25></a><span class=s2>            &lt;li&gt;&lt;strong&gt;Total Edges:&lt;/strong&gt; 981&lt;/li&gt;</span>
</span><span id=__span-18-26><a id=__codelineno-18-26 name=__codelineno-18-26 href=#__codelineno-18-26></a><span class=s2>            &lt;li&gt;&lt;strong&gt;Transformer Layers:&lt;/strong&gt; 28&lt;/li&gt;</span>
</span><span id=__span-18-27><a id=__codelineno-18-27 name=__codelineno-18-27 href=#__codelineno-18-27></a><span class=s2>            &lt;li&gt;&lt;strong&gt;Attention Heads per Layer:&lt;/strong&gt; 32&lt;/li&gt;</span>
</span><span id=__span-18-28><a id=__codelineno-18-28 name=__codelineno-18-28 href=#__codelineno-18-28></a><span class=s2>            &lt;li&gt;&lt;strong&gt;Total Parameters:&lt;/strong&gt; ~2.8 billion&lt;/li&gt;</span>
</span><span id=__span-18-29><a id=__codelineno-18-29 name=__codelineno-18-29 href=#__codelineno-18-29></a><span class=s2>            &lt;li&gt;&lt;strong&gt;File Size:&lt;/strong&gt; 1.88 GB&lt;/li&gt;</span>
</span><span id=__span-18-30><a id=__codelineno-18-30 name=__codelineno-18-30 href=#__codelineno-18-30></a><span class=s2>        &lt;/ul&gt;</span>
</span><span id=__span-18-31><a id=__codelineno-18-31 name=__codelineno-18-31 href=#__codelineno-18-31></a><span class=s2>    &lt;/div&gt;</span>
</span><span id=__span-18-32><a id=__codelineno-18-32 name=__codelineno-18-32 href=#__codelineno-18-32></a>
</span><span id=__span-18-33><a id=__codelineno-18-33 name=__codelineno-18-33 href=#__codelineno-18-33></a><span class=s2>    &lt;div class=&quot;visualization&quot;&gt;</span>
</span><span id=__span-18-34><a id=__codelineno-18-34 name=__codelineno-18-34 href=#__codelineno-18-34></a><span class=s2>        &lt;h2&gt;ğŸ—ºï¸ Main Architecture (929 nodes)&lt;/h2&gt;</span>
</span><span id=__span-18-35><a id=__codelineno-18-35 name=__codelineno-18-35 href=#__codelineno-18-35></a><span class=s2>        &lt;iframe src=&quot;</span><span class=si>{</span><span class=n>main_url</span><span class=si>}</span><span class=s2>&quot;&gt;&lt;/iframe&gt;</span>
</span><span id=__span-18-36><a id=__codelineno-18-36 name=__codelineno-18-36 href=#__codelineno-18-36></a><span class=s2>    &lt;/div&gt;</span>
</span><span id=__span-18-37><a id=__codelineno-18-37 name=__codelineno-18-37 href=#__codelineno-18-37></a>
</span><span id=__span-18-38><a id=__codelineno-18-38 name=__codelineno-18-38 href=#__codelineno-18-38></a><span class=s2>    &lt;div class=&quot;visualization&quot;&gt;</span>
</span><span id=__span-18-39><a id=__codelineno-18-39 name=__codelineno-18-39 href=#__codelineno-18-39></a><span class=s2>        &lt;h2&gt;ğŸ” Layer 1 Detail (35 nodes)&lt;/h2&gt;</span>
</span><span id=__span-18-40><a id=__codelineno-18-40 name=__codelineno-18-40 href=#__codelineno-18-40></a><span class=s2>        &lt;iframe src=&quot;</span><span class=si>{</span><span class=n>layer1_url</span><span class=si>}</span><span class=s2>&quot;&gt;&lt;/iframe&gt;</span>
</span><span id=__span-18-41><a id=__codelineno-18-41 name=__codelineno-18-41 href=#__codelineno-18-41></a><span class=s2>    &lt;/div&gt;</span>
</span><span id=__span-18-42><a id=__codelineno-18-42 name=__codelineno-18-42 href=#__codelineno-18-42></a>
</span><span id=__span-18-43><a id=__codelineno-18-43 name=__codelineno-18-43 href=#__codelineno-18-43></a><span class=s2>    &lt;!-- Layers 2-5 ... --&gt;</span>
</span><span id=__span-18-44><a id=__codelineno-18-44 name=__codelineno-18-44 href=#__codelineno-18-44></a>
</span><span id=__span-18-45><a id=__codelineno-18-45 name=__codelineno-18-45 href=#__codelineno-18-45></a><span class=s2>    &lt;div class=&quot;visualization&quot;&gt;</span>
</span><span id=__span-18-46><a id=__codelineno-18-46 name=__codelineno-18-46 href=#__codelineno-18-46></a><span class=s2>        &lt;h2&gt;ğŸ¯ Attention Heads Analysis (896 nodes)&lt;/h2&gt;</span>
</span><span id=__span-18-47><a id=__codelineno-18-47 name=__codelineno-18-47 href=#__codelineno-18-47></a><span class=s2>        &lt;iframe src=&quot;</span><span class=si>{</span><span class=n>attention_url</span><span class=si>}</span><span class=s2>&quot;&gt;&lt;/iframe&gt;</span>
</span><span id=__span-18-48><a id=__codelineno-18-48 name=__codelineno-18-48 href=#__codelineno-18-48></a><span class=s2>    &lt;/div&gt;</span>
</span><span id=__span-18-49><a id=__codelineno-18-49 name=__codelineno-18-49 href=#__codelineno-18-49></a>
</span><span id=__span-18-50><a id=__codelineno-18-50 name=__codelineno-18-50 href=#__codelineno-18-50></a><span class=s2>    &lt;div class=&quot;visualization&quot;&gt;</span>
</span><span id=__span-18-51><a id=__codelineno-18-51 name=__codelineno-18-51 href=#__codelineno-18-51></a><span class=s2>        &lt;h2&gt;ğŸ“¦ Quantization Blocks (112 nodes)&lt;/h2&gt;</span>
</span><span id=__span-18-52><a id=__codelineno-18-52 name=__codelineno-18-52 href=#__codelineno-18-52></a><span class=s2>        &lt;iframe src=&quot;</span><span class=si>{</span><span class=n>quant_url</span><span class=si>}</span><span class=s2>&quot;&gt;&lt;/iframe&gt;</span>
</span><span id=__span-18-53><a id=__codelineno-18-53 name=__codelineno-18-53 href=#__codelineno-18-53></a><span class=s2>    &lt;/div&gt;</span>
</span><span id=__span-18-54><a id=__codelineno-18-54 name=__codelineno-18-54 href=#__codelineno-18-54></a><span class=s2>&lt;/body&gt;</span>
</span><span id=__span-18-55><a id=__codelineno-18-55 name=__codelineno-18-55 href=#__codelineno-18-55></a><span class=s2>&lt;/html&gt;</span>
</span><span id=__span-18-56><a id=__codelineno-18-56 name=__codelineno-18-56 href=#__codelineno-18-56></a><span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-18-57><a id=__codelineno-18-57 name=__codelineno-18-57 href=#__codelineno-18-57></a>
</span><span id=__span-18-58><a id=__codelineno-18-58 name=__codelineno-18-58 href=#__codelineno-18-58></a><span class=c1># Save dashboard</span>
</span><span id=__span-18-59><a id=__codelineno-18-59 name=__codelineno-18-59 href=#__codelineno-18-59></a><span class=n>dashboard_path</span> <span class=o>=</span> <span class=s2>&quot;/kaggle/working/complete_dashboard.html&quot;</span>
</span><span id=__span-18-60><a id=__codelineno-18-60 name=__codelineno-18-60 href=#__codelineno-18-60></a><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>dashboard_path</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-18-61><a id=__codelineno-18-61 name=__codelineno-18-61 href=#__codelineno-18-61></a>    <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>html_content</span><span class=p>)</span>
</span><span id=__span-18-62><a id=__codelineno-18-62 name=__codelineno-18-62 href=#__codelineno-18-62></a>
</span><span id=__span-18-63><a id=__codelineno-18-63 name=__codelineno-18-63 href=#__codelineno-18-63></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;âœ… Complete dashboard saved: </span><span class=si>{</span><span class=n>dashboard_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-18-64><a id=__codelineno-18-64 name=__codelineno-18-64 href=#__codelineno-18-64></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;ğŸ“¥ Download this file to view all visualizations offline!&quot;</span><span class=p>)</span>
</span></code></pre></div></p> <hr> <h2 id=key-learnings>ğŸ“ Key Learnings<a class=headerlink href=#key-learnings title="Permanent link">&para;</a></h2> <h3 id=1-architecture-insights>1. Architecture Insights<a class=headerlink href=#1-architecture-insights title="Permanent link">&para;</a></h3> <p><strong>Information Flow:</strong> - Input â†’ Embedding (vocabulary projection) - 28 Sequential Transformer Blocks (feature extraction) - Output â†’ Vocabulary Logits (next token prediction)</p> <p><strong>Parameter Distribution:</strong> - Embedding: 393M (21%) - Transformers: 1,764M (64%) - Output: 393M (21%)</p> <p><strong>Attention Pattern:</strong> - 32 heads per layer = 896 total heads - Each head processes ~96 dimensions - Parallel computation within layer - Sequential information flow between layers</p> <h3 id=2-quantization-impact>2. Quantization Impact<a class=headerlink href=#2-quantization-impact title="Permanent link">&para;</a></h3> <p><strong>Q4_K_M Quantization:</strong> - Mixed 4-bit and 6-bit quantization - Super-block structure (4 Ã— 8 Ã— 32 weights) - Preserves important weights at higher precision - 75% compression (vs FP16)</p> <p><strong>Memory Distribution:</strong> - Weights: ~1.88 GB - KV Cache (4K context): ~0.5 GB - Activations: ~0.2 GB - <strong>Total VRAM: ~2.6 GB</strong></p> <h3 id=3-split-gpu-benefits>3. Split-GPU Benefits<a class=headerlink href=#3-split-gpu-benefits title="Permanent link">&para;</a></h3> <p><strong>Why Split-GPU?</strong> 1. <strong>Resource Isolation</strong>: LLM doesn't compete with visualization 2. <strong>Parallel Processing</strong>: Query model while analyzing 3. <strong>Memory Efficiency</strong>: Each GPU handles its workload 4. <strong>Scalability</strong>: Can add more GPUs for larger models</p> <p><strong>Performance:</strong> - GPU 0 (LLM): 45 tokens/sec - GPU 1 (Analytics): PageRank in &lt;2 seconds - Combined: No performance degradation</p> <hr> <h2 id=research-applications>ğŸ” Research Applications<a class=headerlink href=#research-applications title="Permanent link">&para;</a></h2> <h3 id=model-analysis>Model Analysis<a class=headerlink href=#model-analysis title="Permanent link">&para;</a></h3> <ol> <li><strong>Architecture Comparison</strong>: Compare quantized vs full-precision</li> <li><strong>Pruning Candidates</strong>: Identify low-importance heads</li> <li><strong>Bottleneck Detection</strong>: Find slow layers</li> <li><strong>Information Flow</strong>: Trace token processing path</li> </ol> <h3 id=optimization>Optimization<a class=headerlink href=#optimization title="Permanent link">&para;</a></h3> <ol> <li><strong>Layer Fusion</strong>: Identify redundant computations</li> <li><strong>Selective Quantization</strong>: Higher precision for important weights</li> <li><strong>Dynamic Inference</strong>: Skip layers for simple queries</li> <li><strong>Knowledge Distillation</strong>: Teacher-student architecture design</li> </ol> <h3 id=debugging>Debugging<a class=headerlink href=#debugging title="Permanent link">&para;</a></h3> <ol> <li><strong>Attention Visualization</strong>: See what model focuses on</li> <li><strong>Layer Output Analysis</strong>: Detect degradation</li> <li><strong>Quantization Validation</strong>: Verify conversion correctness</li> <li><strong>Performance Profiling</strong>: Identify slow components</li> </ol> <hr> <h2 id=outputs>ğŸ“ Outputs<a class=headerlink href=#outputs title="Permanent link">&para;</a></h2> <h3 id=files-generated>Files Generated<a class=headerlink href=#files-generated title="Permanent link">&para;</a></h3> <ol> <li><strong>complete_dashboard.html</strong> (5 MB)</li> <li>All-in-one interactive dashboard</li> <li>Downloadable from <code>/kaggle/working/</code></li> <li> <p>Works offline after download</p> </li> <li> <p><strong>architecture_graph.json</strong> (2 MB)</p> </li> <li>Complete graph structure</li> <li> <p>Import into other graph tools (Gephi, Cytoscape)</p> </li> <li> <p><strong>pagerank_results.csv</strong> (50 KB)</p> </li> <li>Node importance scores</li> <li> <p>Use for pruning decisions</p> </li> <li> <p><strong>layer_statistics.csv</strong> (20 KB)</p> </li> <li>Per-layer metrics</li> <li>Parameter counts, memory usage</li> </ol> <h3 id=cloud-urls-8-total>Cloud URLs (8 total)<a class=headerlink href=#cloud-urls-8-total title="Permanent link">&para;</a></h3> <ul> <li>Main architecture (929 nodes)</li> <li>Layers 1-5 (35 nodes each)</li> <li>Attention heads (896 nodes)</li> <li>Quantization blocks (112 nodes)</li> </ul> <hr> <h2 id=next-steps>ğŸš€ Next Steps<a class=headerlink href=#next-steps title="Permanent link">&para;</a></h2> <h3 id=after-completing-this-tutorial>After Completing This Tutorial<a class=headerlink href=#after-completing-this-tutorial title="Permanent link">&para;</a></h3> <ol> <li><strong>Experiment with Other Models</strong></li> <li>Try 1B, 7B, or 13B models</li> <li>Compare architectures</li> <li> <p>Analyze quantization impact</p> </li> <li> <p><strong>Advanced Analytics</strong></p> </li> <li>Community detection (find module groups)</li> <li>Shortest paths (trace information flow)</li> <li> <p>Clustering (group similar heads)</p> </li> <li> <p><strong>Custom Visualizations</strong></p> </li> <li>Add custom metrics</li> <li>Create animation sequences</li> <li> <p>Build comparison dashboards</p> </li> <li> <p><strong>Production Deployment</strong></p> </li> <li>Automate dashboard generation</li> <li>Create monitoring pipeline</li> <li>Build CI/CD integration</li> </ol> <hr> <h2 id=troubleshooting>ğŸ› ï¸ Troubleshooting<a class=headerlink href=#troubleshooting title="Permanent link">&para;</a></h2> <h3 id=common-issues>Common Issues<a class=headerlink href=#common-issues title="Permanent link">&para;</a></h3> <p><strong>GPU Out of Memory:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=c1># Reduce model context size</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=n>config</span><span class=o>.</span><span class=n>n_ctx</span> <span class=o>=</span> <span class=mi>2048</span>  <span class=c1># Instead of 4096</span>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=c1># Or use smaller model</span>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=n>model</span> <span class=o>=</span> <span class=s2>&quot;Llama-3.2-1B-Q4_K_M.gguf&quot;</span>
</span></code></pre></div></p> <p><strong>Graphistry Upload Timeout:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=c1># Use smaller subgraphs</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a><span class=n>layer_subgraph</span> <span class=o>=</span> <span class=n>G</span><span class=o>.</span><span class=n>subgraph</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=n>G</span><span class=o>.</span><span class=n>nodes</span><span class=p>())[:</span><span class=mi>100</span><span class=p>])</span>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=c1># Or save locally first</span>
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=n>g</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>render</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>as_files</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></code></pre></div></p> <p><strong>cuGraph Installation Fails:</strong> <div class="language-bash highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=c1># Use CPU-based PageRank instead</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>import<span class=w> </span>networkx<span class=w> </span>as<span class=w> </span>nx
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=nv>pagerank</span><span class=w> </span><span class=o>=</span><span class=w> </span>nx.pagerank<span class=o>(</span>G<span class=o>)</span>
</span></code></pre></div></p> <h3 id=performance-optimization>Performance Optimization<a class=headerlink href=#performance-optimization title="Permanent link">&para;</a></h3> <p><strong>Speed Up Analytics:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=c1># Reduce graph size</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=n>G_small</span> <span class=o>=</span> <span class=n>nx</span><span class=o>.</span><span class=n>k_core</span><span class=p>(</span><span class=n>G</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>  <span class=c1># Remove low-degree nodes</span>
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a>
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=c1># Sample attention heads</span>
</span><span id=__span-22-5><a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a><span class=n>sample_heads</span> <span class=o>=</span> <span class=p>[</span><span class=sa>f</span><span class=s2>&quot;L</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>_H</span><span class=si>{</span><span class=n>j</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>29</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=mi>2</span><span class=p>)]</span>
</span><span id=__span-22-6><a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a><span class=n>G_sample</span> <span class=o>=</span> <span class=n>G</span><span class=o>.</span><span class=n>subgraph</span><span class=p>(</span><span class=n>sample_heads</span><span class=p>)</span>
</span></code></pre></div></p> <p><strong>Reduce Memory Usage:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=c1># Process layers sequentially</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=k>for</span> <span class=n>layer</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>29</span><span class=p>):</span>
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a>    <span class=n>layer_graph</span> <span class=o>=</span> <span class=n>extract_layer</span><span class=p>(</span><span class=n>G</span><span class=p>,</span> <span class=n>layer</span><span class=p>)</span>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a>    <span class=n>analyze_and_save</span><span class=p>(</span><span class=n>layer_graph</span><span class=p>)</span>
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a>    <span class=k>del</span> <span class=n>layer_graph</span>  <span class=c1># Free memory</span>
</span></code></pre></div></p> <hr> <h2 id=additional-resources>ğŸ“š Additional Resources<a class=headerlink href=#additional-resources title="Permanent link">&para;</a></h2> <h3 id=related-tutorials>Related Tutorials<a class=headerlink href=#related-tutorials title="Permanent link">&para;</a></h3> <ul> <li><a href=../06-split-gpu-graphistry/ >Tutorial 06: Split-GPU Graphistry</a> - Foundation for this tutorial</li> <li><a href=../04-gguf-quantization/ >Tutorial 04: GGUF Quantization</a> - Understanding Q4_K_M</li> <li><a href=../03-multi-gpu/ >Tutorial 03: Multi-GPU Inference</a> - GPU management basics</li> </ul> <h3 id=external-documentation>External Documentation<a class=headerlink href=#external-documentation title="Permanent link">&para;</a></h3> <ul> <li><a href=https://hub.graphistry.com/docs/ >Graphistry Documentation</a></li> <li><a href=https://docs.rapids.ai/api/cugraph/stable/ >RAPIDS cuGraph Guide</a></li> <li><a href=https://networkx.org/documentation/stable/tutorial.html>NetworkX Tutorial</a></li> <li><a href=https://github.com/ggerganov/ggml/blob/master/docs/gguf.md>GGUF Format Specification</a></li> </ul> <h3 id=academic-papers>Academic Papers<a class=headerlink href=#academic-papers title="Permanent link">&para;</a></h3> <ul> <li>"Attention Is All You Need" (Vaswani et al., 2017) - Transformer architecture</li> <li>"LLaMA: Open and Efficient Foundation Language Models" (Touvron et al., 2023)</li> <li>"GGML: Tensor Library for Machine Learning" (Ggerganov, 2023)</li> </ul> <hr> <h2 id=conclusion>ğŸ‰ Conclusion<a class=headerlink href=#conclusion title="Permanent link">&para;</a></h2> <p>Congratulations! You've completed the most advanced tutorial in the llcuda v2.2.0 series. You now have:</p> <p>âœ… Interactive visualizations of complete model architecture âœ… Layer-by-layer analysis of transformer blocks âœ… PageRank scores for all 929 components âœ… Downloadable HTML dashboards âœ… Research-grade graph analytics âœ… Production-ready visualization pipeline</p> <p>This tutorial represents the cutting edge of GGUF model analysis and demonstrates llcuda's full capabilities. Use these techniques to: - Understand your models deeply - Optimize inference performance - Make informed quantization decisions - Publish research-quality visualizations</p> <hr> <h2 id=citation>ğŸ“– Citation<a class=headerlink href=#citation title="Permanent link">&para;</a></h2> <p>If you use this visualization tool in your research, please cite:</p> <div class="language-bibtex highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=nc>@software</span><span class=p>{</span><span class=nl>llcuda2026</span><span class=p>,</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=w>  </span><span class=na>title</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>{llcuda: CUDA 12 Inference Backend for Unsloth with GGUF Visualization}</span><span class=p>,</span>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=w>  </span><span class=na>author</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>{Muhammad, Waqas}</span><span class=p>,</span>
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=w>  </span><span class=na>year</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>{2026}</span><span class=p>,</span>
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=w>  </span><span class=na>version</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>{2.2.0}</span><span class=p>,</span>
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=w>  </span><span class=na>url</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>{https://github.com/llcuda/llcuda}</span>
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=p>}</span>
</span></code></pre></div> <hr> <p><strong>Ready to visualize?</strong> <a href=https://kaggle.com/code>Open this notebook in Kaggle</a> and start exploring! ğŸš€</p> <form class=md-feedback name=feedback hidden> <fieldset> <legend class=md-feedback__title> Was this page helpful? </legend> <div class=md-feedback__inner> <div class=md-feedback__list> <button class="md-feedback__icon md-icon" type=submit title="This page was helpful" data-md-value=1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg> </button> <button class="md-feedback__icon md-icon" type=submit title="This page could be improved" data-md-value=0> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg> </button> </div> <div class=md-feedback__note> <div data-md-value=1 hidden> Thanks for your feedback! </div> <div data-md-value=0 hidden> Thanks for your feedback! Help us improve by <a href=https://github.com/llcuda/llcuda/issues/new target=_blank rel=noopener>opening an issue</a>. </div> </div> </div> </fieldset> </form> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../10-complete-workflow/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Complete Workflow"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Complete Workflow </div> </div> </a> <a href=../../architecture/overview/ class="md-footer__link md-footer__link--next" aria-label="Next: Architecture Overview"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Architecture Overview </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024-2026 Waqas Muhammad </div> </div> <div class=md-social> <a href=https://github.com/llcuda/llcuda target=_blank rel=noopener title="GitHub - llcuda/llcuda" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://github.com/waqasm86 target=_blank rel=noopener title="GitHub - waqasm86" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=mailto:waqasm86@gmail.com target=_blank rel=noopener title="Email - waqasm86@gmail.com" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l208 156a48 48 0 0 0 57.6 0l208-156c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48zM0 196v188c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V196L313.6 344.8c-34.1 25.6-81.1 25.6-115.2 0z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Cookie consent</h4> <p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">Accept</button> <label class=md-button for=__settings>Manage settings</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["content.code.annotate", "content.code.copy", "content.footnote.tooltips", "content.tabs.link", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> <script src=../../javascripts/mathjax.js></script> <script src=../../javascripts/schema.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>